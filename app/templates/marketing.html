{% extends 'base.html' %}

{% block app_content %}
    {% if previous_period_total %}
        <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th scope="col">Research price / Проучване на цени</th>
                    {% for product in products %}
                       <th scope="col">{{product.name}}</th>
                    {% endfor %}
              </tr>
            </thead>
            {% for player in players %}
                <tr>
                    <td>{{player.display_name}}</td>
                    {% for period in player.periods|sort(attribute='id') %}
                        {% if period.period_number == previous_period_total.period_number %}
                            {% if period.user_id == user.id %}
                                <td>{{period.sell_price}}</td>
                            {% elif show.price1 and period.product_id== 1 %}
                                <td>{{period.sell_price}}</td>
                            {% elif show.price2 and period.product_id== 2 %}
                                <td>{{period.sell_price}}</td>
                            {% elif show.price3 and period.product_id== 3 %}
                                <td>{{period.sell_price}}</td>
                            {% else %}
                                <td>-</td>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
            <tr><td>----</td><td>----</td><td>----</td><td>----</td></tr>
            <thead>
              <tr>
                <th scope="col">Research sales quantity / Проучване на брой продажби</th>
                    {% for product in products %}
                       <th scope="col">{{product.name}}</th>
                    {% endfor %}
              </tr>
            </thead>
            {% for player in players %}
                <tr>
                    <td>{{player.display_name}}</td>
                    {% for period in player.periods|sort(attribute='id') %}
                        {% if period.period_number == previous_period_total.period_number %}
                            {% if period.user_id == user.id %}
                                <td>{{period.total_sells}} </td>
                            {% elif show.sales1 and period.product_id==1 %}
                                <td>{{period.total_sells}}</td>
                            {% elif show.sales2 and period.product_id==2 %}
                                <td>{{period.total_sells}}</td>
                            {% elif show.sales3 and period.product_id==3 %}
                                <td>{{period.total_sells}}</td>
                            {% else %}
                                <td>- </td>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
            <tr><td>----</td><td>----</td><td>----</td><td>----</td></tr>
            <thead>
              <tr>
                <th scope="col">Research quality index / Проучване на индекс на качество</th>
                    {% for product in products %}
                       <th scope="col">{{product.name}}</th>
                    {% endfor %}
              </tr>
            </thead>
            {% for player in players %}
                <tr>
                    <td>{{player.display_name}}</td>
                    {% for period in player.periods|sort(attribute='id') %}
                        {% if period.period_number == previous_period_total.period_number %}
                            {% if period.user_id == user.id %}
                                <td>{{period.index_quality}} </td>
                            {% elif show.quality1 and period.product_id==1 %}
                                <td>{{period.index_quality}}</td>
                            {% elif show.quality2 and period.product_id==2 %}
                                <td>{{period.index_quality}}</td>
                            {% elif show.quality3 and period.product_id==3 %}
                                <td>{{period.index_quality}}</td>
                            {% else %}
                                <td>- </td>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
            <tr><td>----</td><td>----</td><td>----</td><td>----</td></tr>
            <thead>
              <tr>
                <th scope="col">Research marketing costs / Проучване на разходи за маркетинг</th>
                    {% for product in products %}
                       <th scope="col">{{product.name}}</th>
                    {% endfor %}
              </tr>
            </thead>
            {% for player in players %}
                <tr>
                    <td>{{player.display_name}}</td>
                    {% for period in player.periods|sort(attribute='id') %}
                        {% if period.period_number == previous_period_total.period_number %}
                            {% if period.user_id == user.id %}
                                <td>{{period.consolidated_marketing_budget}} </td>
                            {% elif show.marketing1 and period.product_id==1 %}
                                <td>{{period.consolidated_marketing_budget}}</td>
                            {% elif show.marketing2 and period.product_id==2 %}
                                <td>{{period.consolidated_marketing_budget}}</td>
                            {% elif show.marketing3 and period.product_id==3 %}
                                <td>{{period.consolidated_marketing_budget}}</td>
                            {% else %}
                                <td>- </td>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>


    {% endif%}
{% endblock %}
